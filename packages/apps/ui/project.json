{
  "name": "ui",
  "$schema": "../../../node_modules/nx/schemas/project-schema.json",
  "sourceRoot": "packages/apps/ui",
  "projectType": "application",
  "tags": ["no-deploy:shared", "ui", "support:serverless"],
  "// targets": "to see all targets run: nx show project ui --web",
  "targets": {
    "cdk-bootstrap": {},
    "cdk-deploy": {
      "dependsOn": ["lambda-build"]
    },
    "build": {
      "cache": false,
      "configurations": {
        "dev": {},
        "prd": {}
      }
    },
    "lambda-build": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cp scripts/lambda_web_adapter.sh .next/standalone/run.sh && cd .next/standalone && zip -r --symlinks ../standalone-server.zip *",
        "cwd": "{projectRoot}"
      },
      "dependsOn": ["build"]
    },
    "dev": {
      "continuous": true,
      "command": "next dev --port 3002 --turbopack",
      "options": {
        "cwd": "{projectRoot}"
      }
    },
    "dev-with-deps": {
      "continuous": true,
      "command": "next dev --port 3002 --turbopack",
      "options": {
        "cwd": "{projectRoot}"
      },
      "dependsOn": [
        {
          "projects": [
            "api",
            "workflow-ingestion",
            "workflow-evaluation",
            "workflow-worker"
          ],
          "target": "serve"
        },
        {
          "projects": ["workflow-worker"],
          "target": "start-ngrok-tunnel"
        }
      ]
    },
    "self-hosted-build": {
      "executor": "@workspace/workspace-plugins:self-hosted-nextjs-build",
      "options": {},
      "dependsOn": [],
      "configurations": {
        "dev": {},
        "prd": {}
      }
    },
    "docker-build": {},
    "docker-push": {},
    "helm-deploy": {},
    "update-image-tag": {
      "configurations": {
        "dev": {
          "filePath": "{projectRoot}/argocd/dev.values.yaml",
          "valuePrefix": "dev-"
        },
        "prd": {
          "filePath": "{projectRoot}/argocd/prd.values.yaml",
          "valuePrefix": "prd-"
        }
      }
    },
    "openapi-gen": {
      "command": "npx @hey-api/openapi-ts -f openapi.config.ts -d",
      "options": {
        "cwd": "{projectRoot}"
      }
    },
    "deploy": {
      "executor": "@workspace/workspace-plugins:proxy-executor",
      "options": {
        "target": "cdk-deploy"
      },
      "dependsOn": [
        "^build",
        {
          "projects": "api",
          "target": "deploy",
          "params": "forward"
        }
      ]
    }
  }
}
